# -*- python -*-
Import("env")

env.Program(["Mask_1.cc"], LIBS=env.libs["vw"] + ["fw"])
env.Program(["MaskedImage_1.cc"], LIBS=env.libs["vw"] + ["fw"] + ["cfitsio"] + ["fitsio"])
env.Program(["BuildExcept.cc"], LIBS="fw")
env.Program(["DataProperty_1.cc"], LIBS="fw")
env.Program(["MaskIO_1.cc"], LIBS=env.libs["vw"] + ["fw"] + ["cfitsio"] + ["fitsio"])
env.Program(["MaskedImageIO_1.cc"], LIBS=env.libs["vw"] + ["fw"] + ["cfitsio"] + ["fitsio"])
env.Program(["lsstdata01.cc"], LIBS=env.libs["vw"] + ["fw"])

env.CheckSwig("python", ilang="c++")
env.Append(SWIGFLAGS=" -Ipython")
fwTests = env.LoadableModuleIncomplete("_fwTests", "fwTests.i",
                                       LIBS=env.libs["vw"] + ["fw"])

import glob, os
env.AppendENVPath('PYTHONPATH', os.environ['PYTHONPATH'])
for f in glob.glob("*.py"):
    target = ".tests/" + f
    env.Command(target, f, 
                "@echo running $SOURCES; python $SOURCES > $TARGET || rm -f $TARGET")
    env.Depends(target, fwTests)
Clean("", ".tests")


